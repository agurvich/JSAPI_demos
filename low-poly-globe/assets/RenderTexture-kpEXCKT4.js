import{gl as E,gm as _,gn as x,gf as i,go as c,gp as A,df as d,a5 as g,gq as m,G as C,cY as p}from"./index-O3Mu8AMX.js";function L(e,o,s,r){if(o==null||r==null)return!1;const t=_(o,r,I);if(t.projector===x)return s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],!0;if(t.projector==null)return!1;const{source:n,dest:a}=t;if(a.spatialReferenceId===i.WEB_MERCATOR){const u=c[n.spatialReferenceId][i.WGS84];return u!=null&&(u(e,0,f,0),A(f,0,s,0),s[3]=h(f[1],e[2],e[3],d.radius),!0)}if(n.spatialReferenceId!==i.WGS84&&n.spatialReferenceId!==i.CGCS2000||a.spatialReferenceId!==i.PLATE_CARREE){t.projector(e,0,s,0);const u=n.metersPerUnit??1,l=a.metersPerUnit??1;s[3]=e[3]*u/l}else{const u=c[n.spatialReferenceId][i.SPHERICAL_ECEF],l=c[i.SPHERICAL_ECEF][i.PLATE_CARREE];let R=e[3];u!=null&&l!=null&&(R=h(e[1],e[2],e[3],d.radius)),t.projector(e,0,s,0),s[3]=R}return!0}function h(e,o,s,r){const t=r+o;if(t<r/2||s>t)return Number.MAX_VALUE;const n=Math.abs(P*e)+Math.asin(s/t);return n>=Math.PI/2?Number.MAX_VALUE:s/Math.cos(n)}const f=g(),I=E(),P=m(1);class S{constructor(o,s){this._textureRep=o,this.loadPromise=null,this._disposed=!1;const r=this._textureRep.acquire(s);C(r)?(r.then(t=>{this._disposed?p(t):this._textureRef=t}),this.loadPromise=r):this._textureRef=r}dispose(){this._textureRef=p(this._textureRef),this._disposed=!0}get glTexture(){return this._textureRef!=null?this._textureRef.glTexture:null}}export{L as a,S as s};

import{f as ae,a as re,b as S,d as ne,e as oe,h as N,j as K}from"./dom-DPjEIMvi.js";/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.6.0
 *//*!
* focus-trap 7.5.4
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function J(o,a){var i=Object.keys(o);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(o);a&&(u=u.filter(function(b){return Object.getOwnPropertyDescriptor(o,b).enumerable})),i.push.apply(i,u)}return i}function Q(o){for(var a=1;a<arguments.length;a++){var i=arguments[a]!=null?arguments[a]:{};a%2?J(Object(i),!0).forEach(function(u){ie(o,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):J(Object(i)).forEach(function(u){Object.defineProperty(o,u,Object.getOwnPropertyDescriptor(i,u))})}return o}function ie(o,a,i){return a=ce(a),a in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i,o}function ue(o,a){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,a||"default");if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(o)}function ce(o){var a=ue(o,"string");return typeof a=="symbol"?a:String(a)}var W={activateTrap:function(a,i){if(a.length>0){var u=a[a.length-1];u!==i&&u.pause()}var b=a.indexOf(i);b===-1||a.splice(b,1),a.push(i)},deactivateTrap:function(a,i){var u=a.indexOf(i);u!==-1&&a.splice(u,1),a.length>0&&a[a.length-1].unpause()}},se=function(a){return a.tagName&&a.tagName.toLowerCase()==="input"&&typeof a.select=="function"},le=function(a){return(a==null?void 0:a.key)==="Escape"||(a==null?void 0:a.key)==="Esc"||(a==null?void 0:a.keyCode)===27},L=function(a){return(a==null?void 0:a.key)==="Tab"||(a==null?void 0:a.keyCode)===9},fe=function(a){return L(a)&&!a.shiftKey},ve=function(a){return L(a)&&a.shiftKey},X=function(a){return setTimeout(a,0)},Z=function(a,i){var u=-1;return a.every(function(b,c){return i(b)?(u=c,!1):!0}),u},C=function(a){for(var i=arguments.length,u=new Array(i>1?i-1:0),b=1;b<i;b++)u[b-1]=arguments[b];return typeof a=="function"?a.apply(void 0,u):a},B=function(a){return a.target.shadowRoot&&typeof a.composedPath=="function"?a.composedPath()[0]:a.target},de=[],be=function(a,i){var u=(i==null?void 0:i.document)||document,b=(i==null?void 0:i.trapStack)||de,c=Q({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:fe,isKeyBackward:ve},i),r={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},g,h=function(t,e,n){return t&&t[e]!==void 0?t[e]:c[n||e]},T=function(t,e){var n=typeof(e==null?void 0:e.composedPath)=="function"?e.composedPath():void 0;return r.containerGroups.findIndex(function(s){var l=s.container,v=s.tabbableNodes;return l.contains(t)||(n==null?void 0:n.includes(l))||v.find(function(d){return d===t})})},E=function(t){var e=c[t];if(typeof e=="function"){for(var n=arguments.length,s=new Array(n>1?n-1:0),l=1;l<n;l++)s[l-1]=arguments[l];e=e.apply(void 0,s)}if(e===!0&&(e=void 0),!e){if(e===void 0||e===!1)return e;throw new Error("`".concat(t,"` was specified but was not a node, or did not return a node"))}var v=e;if(typeof e=="string"&&(v=u.querySelector(e),!v))throw new Error("`".concat(t,"` as selector refers to no known node"));return v},D=function(){var t=E("initialFocus");if(t===!1)return!1;if(t===void 0||!S(t,c.tabbableOptions))if(T(u.activeElement)>=0)t=u.activeElement;else{var e=r.tabbableGroups[0],n=e&&e.firstTabbableNode;t=n||E("fallbackFocus")}if(!t)throw new Error("Your focus-trap needs to have at least one focusable element");return t},P=function(){if(r.containerGroups=r.containers.map(function(t){var e=ne(t,c.tabbableOptions),n=oe(t,c.tabbableOptions),s=e.length>0?e[0]:void 0,l=e.length>0?e[e.length-1]:void 0,v=n.find(function(p){return N(p)}),d=n.slice().reverse().find(function(p){return N(p)}),m=!!e.find(function(p){return K(p)>0});return{container:t,tabbableNodes:e,focusableNodes:n,posTabIndexesFound:m,firstTabbableNode:s,lastTabbableNode:l,firstDomTabbableNode:v,lastDomTabbableNode:d,nextTabbableNode:function(w){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=e.indexOf(w);return y<0?O?n.slice(n.indexOf(w)+1).find(function(R){return N(R)}):n.slice(0,n.indexOf(w)).reverse().find(function(R){return N(R)}):e[y+(O?1:-1)]}}}),r.tabbableGroups=r.containerGroups.filter(function(t){return t.tabbableNodes.length>0}),r.tabbableGroups.length<=0&&!E("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(r.containerGroups.find(function(t){return t.posTabIndexesFound})&&r.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},_=function f(t){var e=t.activeElement;if(e)return e.shadowRoot&&e.shadowRoot.activeElement!==null?f(e.shadowRoot):e},F=function f(t){if(t!==!1&&t!==_(document)){if(!t||!t.focus){f(D());return}t.focus({preventScroll:!!c.preventScroll}),r.mostRecentlyFocusedNode=t,se(t)&&t.select()}},U=function(t){var e=E("setReturnFocus",t);return e||(e===!1?!1:t)},q=function(t){var e=t.target,n=t.event,s=t.isBackward,l=s===void 0?!1:s;e=e||B(n),P();var v=null;if(r.tabbableGroups.length>0){var d=T(e,n),m=d>=0?r.containerGroups[d]:void 0;if(d<0)l?v=r.tabbableGroups[r.tabbableGroups.length-1].lastTabbableNode:v=r.tabbableGroups[0].firstTabbableNode;else if(l){var p=Z(r.tabbableGroups,function(I){var x=I.firstTabbableNode;return e===x});if(p<0&&(m.container===e||S(e,c.tabbableOptions)&&!N(e,c.tabbableOptions)&&!m.nextTabbableNode(e,!1))&&(p=d),p>=0){var w=p===0?r.tabbableGroups.length-1:p-1,O=r.tabbableGroups[w];v=K(e)>=0?O.lastTabbableNode:O.lastDomTabbableNode}else L(n)||(v=m.nextTabbableNode(e,!1))}else{var y=Z(r.tabbableGroups,function(I){var x=I.lastTabbableNode;return e===x});if(y<0&&(m.container===e||S(e,c.tabbableOptions)&&!N(e,c.tabbableOptions)&&!m.nextTabbableNode(e))&&(y=d),y>=0){var R=y===r.tabbableGroups.length-1?0:y+1,z=r.tabbableGroups[R];v=K(e)>=0?z.firstTabbableNode:z.firstDomTabbableNode}else L(n)||(v=m.nextTabbableNode(e))}}else v=E("fallbackFocus");return v},A=function(t){var e=B(t);if(!(T(e,t)>=0)){if(C(c.clickOutsideDeactivates,t)){g.deactivate({returnFocus:c.returnFocusOnDeactivate});return}C(c.allowOutsideClick,t)||t.preventDefault()}},H=function(t){var e=B(t),n=T(e,t)>=0;if(n||e instanceof Document)n&&(r.mostRecentlyFocusedNode=e);else{t.stopImmediatePropagation();var s,l=!0;if(r.mostRecentlyFocusedNode)if(K(r.mostRecentlyFocusedNode)>0){var v=T(r.mostRecentlyFocusedNode),d=r.containerGroups[v].tabbableNodes;if(d.length>0){var m=d.findIndex(function(p){return p===r.mostRecentlyFocusedNode});m>=0&&(c.isKeyForward(r.recentNavEvent)?m+1<d.length&&(s=d[m+1],l=!1):m-1>=0&&(s=d[m-1],l=!1))}}else r.containerGroups.some(function(p){return p.tabbableNodes.some(function(w){return K(w)>0})})||(l=!1);else l=!1;l&&(s=q({target:r.mostRecentlyFocusedNode,isBackward:c.isKeyBackward(r.recentNavEvent)})),F(s||r.mostRecentlyFocusedNode||D())}r.recentNavEvent=void 0},ee=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r.recentNavEvent=t;var n=q({event:t,isBackward:e});n&&(L(t)&&t.preventDefault(),F(n))},M=function(t){if(le(t)&&C(c.escapeDeactivates,t)!==!1){t.preventDefault(),g.deactivate();return}(c.isKeyForward(t)||c.isKeyBackward(t))&&ee(t,c.isKeyBackward(t))},Y=function(t){var e=B(t);T(e,t)>=0||C(c.clickOutsideDeactivates,t)||C(c.allowOutsideClick,t)||(t.preventDefault(),t.stopImmediatePropagation())},V=function(){if(r.active)return W.activateTrap(b,g),r.delayInitialFocusTimer=c.delayInitialFocus?X(function(){F(D())}):F(D()),u.addEventListener("focusin",H,!0),u.addEventListener("mousedown",A,{capture:!0,passive:!1}),u.addEventListener("touchstart",A,{capture:!0,passive:!1}),u.addEventListener("click",Y,{capture:!0,passive:!1}),u.addEventListener("keydown",M,{capture:!0,passive:!1}),g},$=function(){if(r.active)return u.removeEventListener("focusin",H,!0),u.removeEventListener("mousedown",A,!0),u.removeEventListener("touchstart",A,!0),u.removeEventListener("click",Y,!0),u.removeEventListener("keydown",M,!0),g},te=function(t){var e=t.some(function(n){var s=Array.from(n.removedNodes);return s.some(function(l){return l===r.mostRecentlyFocusedNode})});e&&F(D())},j=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(te):void 0,k=function(){j&&(j.disconnect(),r.active&&!r.paused&&r.containers.map(function(t){j.observe(t,{subtree:!0,childList:!0})}))};return g={get active(){return r.active},get paused(){return r.paused},activate:function(t){if(r.active)return this;var e=h(t,"onActivate"),n=h(t,"onPostActivate"),s=h(t,"checkCanFocusTrap");s||P(),r.active=!0,r.paused=!1,r.nodeFocusedBeforeActivation=u.activeElement,e==null||e();var l=function(){s&&P(),V(),k(),n==null||n()};return s?(s(r.containers.concat()).then(l,l),this):(l(),this)},deactivate:function(t){if(!r.active)return this;var e=Q({onDeactivate:c.onDeactivate,onPostDeactivate:c.onPostDeactivate,checkCanReturnFocus:c.checkCanReturnFocus},t);clearTimeout(r.delayInitialFocusTimer),r.delayInitialFocusTimer=void 0,$(),r.active=!1,r.paused=!1,k(),W.deactivateTrap(b,g);var n=h(e,"onDeactivate"),s=h(e,"onPostDeactivate"),l=h(e,"checkCanReturnFocus"),v=h(e,"returnFocus","returnFocusOnDeactivate");n==null||n();var d=function(){X(function(){v&&F(U(r.nodeFocusedBeforeActivation)),s==null||s()})};return v&&l?(l(U(r.nodeFocusedBeforeActivation)).then(d,d),this):(d(),this)},pause:function(t){if(r.paused||!r.active)return this;var e=h(t,"onPause"),n=h(t,"onPostPause");return r.paused=!0,e==null||e(),$(),k(),n==null||n(),this},unpause:function(t){if(!r.paused||!r.active)return this;var e=h(t,"onUnpause"),n=h(t,"onPostUnpause");return r.paused=!1,e==null||e(),P(),V(),k(),n==null||n(),this},updateContainerElements:function(t){var e=[].concat(t).filter(Boolean);return r.containers=e.map(function(n){return typeof n=="string"?u.querySelector(n):n}),r.active&&P(),k(),this}},g.updateContainerElements(a),g};const G=globalThis.calciteConfig,pe=(G==null?void 0:G.focusTrapStack)||[];function he(o,a){const{el:i}=o,u=(a==null?void 0:a.focusTrapEl)||i;if(!u)return;const b={clickOutsideDeactivates:!0,escapeDeactivates:!1,fallbackFocus:u,setReturnFocus:c=>(ae(c),!1),...a==null?void 0:a.focusTrapOptions,document:i.ownerDocument,tabbableOptions:re,trapStack:pe};o.focusTrap=be(u,b)}function ge(o,a){var i;o.focusTrapDisabled||(i=o.focusTrap)==null||i.activate(a)}function ye(o,a){var i;(i=o.focusTrap)==null||i.deactivate(a)}function Fe(o){var a;(a=o.focusTrap)==null||a.updateContainerElements(o.el)}export{ge as a,he as c,ye as d,Fe as u};
